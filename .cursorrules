# R√àGLES OBLIGATOIRES - GESTION DES T√ÇCHES

## ‚ö†Ô∏è CONTRAINTES STRICTES

### 1. AVANT TOUTE MODIFICATION DE CODE

**INTERDICTION** de coder sans t√¢che document√©e.

**WORKFLOW OBLIGATOIRE** :
1. V√©rifier si t√¢che existe dans `.cursor/BACKLOG.md`
2. Si NON ‚Üí Cr√©er t√¢che dans BACKLOG.md avec √©valuation (priorit√© + temps)
3. Demander √† Cursor d'√©valuer les priorit√©s
4. Cr√©er dossier de doc `.cursor/tasks/TASK-XXX-nom/`
5. D√©placer t√¢che dans TODO personnel (Guillaume ou Associ√©e)
6. ALORS SEULEMENT commencer √† coder

**SI USER DEMANDE DE CODER DIRECTEMENT** :
‚Üí Cursor DOIT refuser poliment et dire :
"‚ö†Ô∏è On doit d'abord cr√©er/documenter la t√¢che dans le BACKLOG. 
Je cr√©e la t√¢che maintenant :
- Titre : [proposition]
- Priorit√© estim√©e : [P?]
- Temps estim√© : [Xh]
- Documentation : .cursor/tasks/TASK-XXX-[nom]/
Valides-tu ?"

---

### 2. PRIORIT√â DES T√ÇCHES INCOMPL√àTES

**R√àGLE** : Les t√¢ches ‚ö†Ô∏è INCOMPLET sont TOUJOURS prioritaires.

**SI T√ÇCHES INCOMPLET EXISTENT** :
‚Üí Cursor DOIT rappeler au d√©marrage de session :
"‚ö†Ô∏è Tu as X t√¢ches INCOMPL√àTES √† finir en priorit√© :
1. TASK-XXX : [titre] (en pause depuis X jours)
2. TASK-YYY : [titre] (en pause depuis Y jours)

Veux-tu :
A) Reprendre une t√¢che INCOMPLET
B) Abandonner une t√¢che (avec revert code + doc raison)
C) Exceptionnellement d√©marrer du nouveau (justifie pourquoi)"

---

### 3. DEFINITION OF DONE STRICTE

**INTERDICTION** de marquer une t√¢che ‚úÖ FINALIS√â sans :
- [x] 1. Code propre et document√©
- [x] 2. Commits sur GitHub main + tous d√©p√¥ts concern√©s (SHA document√©s)
- [x] 3. Test√© en live sur minimum 2 sites (r√©sultats document√©s)

**WORKFLOW** :
‚Üí Cursor v√©rifie la checklist et refuse si crit√®res non remplis

---

### 4. ABANDON DE T√ÇCHE = NETTOYAGE CODE

**INTERDICTION** de marquer ‚ùå ABANDONN√âE sans :
- [x] Code compl√®tement revert√© (git revert + SHA document√©s)
- [x] Sites red√©ploy√©s en version clean si n√©cessaire
- [x] git status clean (aucun fichier modifi√© r√©siduel)
- [x] Raison d'abandon document√©e

**SI USER VEUT ABANDONNER** :
‚Üí Cursor liste tous les commits √† revert
‚Üí Cursor v√©rifie le nettoyage AVANT de marquer abandonn√©

---

### 5. DOCUMENTATION OBLIGATOIRE

**CHAQUE T√ÇCHE** doit avoir son dossier `.cursor/tasks/TASK-XXX-nom/` avec :
- README.md (vue d'ensemble)
- context.md (pourquoi)
- progress.md (journal chronologique)
- commits.md (SHA GitHub)
- tests.md (sites test√©s + r√©sultats)
- decisions.md (choix techniques)

**INTERDICTION** de documenter dans le code source (commentaires OK, mais pas de gros blocs de contexte)

---

### 6. √âVALUATION SYST√âMATIQUE

**AVANT** de d√©marrer une t√¢che, Cursor DOIT √©valuer :
- **Priorit√©** : P0 (critique) | P1 (important) | P2 (normal) | P3 (nice-to-have)
- **Temps** : Estimation en heures/jours
- **Assignation** : Guillaume | Associ√©e | Les deux
- **Raison** : Justification de la priorisation

**FORMAT R√âPONSE CURSOR** :
```
üìä √âVALUATION T√ÇCHE

Priorit√© : P1
Temps estim√© : 5h
Assign√© √† : Guillaume
Raison : Bug impactant 3 sites en prod, bloque les users

Ordre de traitement recommand√© :
1. Cette t√¢che (P1, 5h)
2. [Autre t√¢che] (P2, 3h)
...
```

---

### 7. COMMANDES CURSOR AUTORIS√âES

User peut demander :
- "Cursor, √©value le backlog"
- "Cursor, cr√©e la t√¢che [description]"
- "Cursor, je d√©marre TASK-XXX"
- "Cursor, log ma session pour TASK-XXX"
- "Cursor, je mets TASK-XXX en pause" (‚Üí ‚ö†Ô∏è INCOMPLET)
- "Cursor, j'abandonne TASK-XXX : [raison]" (‚Üí v√©rif revert)
- "Cursor, finalise TASK-XXX" (‚Üí v√©rif DoD)
- "Cursor, montre les INCOMPLET"
- "Cursor, clean tasks" (‚Üí workflow fin journ√©e, voir WORKFLOW-CLEAN-TASKS.md)

---

### 8. V√âRIFICATIONS PR√â-CODE (NOUVEAU - CRITIQUE)

**AVANT CHAQUE modification de code, Cursor DOIT v√©rifier** :

Voir `.cursor/CHECKLIST-PRE-CODE.md` pour checklist compl√®te.

#### RED FLAGS - STOP Imm√©diatement

**Si demande utilisateur contient** :

```
üö® "modifier canonical"
üö® "changer URL"
üö® "supprimer page"
üö® "modifier getCanonicalUrl()"
üö® "toucher au SEO"
```

**Cursor DOIT** :
‚Üí STOP et afficher :
```
‚ö†Ô∏è STOP - Modification SEO Critique D√©tect√©e

Tu veux [modifier canonical/URL/etc.].
Impact potentiel : Perte ranking Google = Perte leads

Avant de continuer :
1. Comprends-tu l'impact business ?
2. As-tu une bonne raison ?
3. As-tu pr√©vu de tester ?

Continue ? (Oui/Non)
```

#### V√©rifications Automatiques

**Avant d'√©crire du code** :

```
‚ñ° Impact SEO ?
  SI OUI ‚Üí V√©rifier ZONES-DE-RISQUE.md + demander confirmation

‚ñ° Fichier dans lib/ ou components/ ?
  SI OUI ‚Üí Pr√©voir sync 11 villes + test 2+ sites

‚ñ° Ville hardcod√©e dans mon code ?
  SI OUI ‚Üí STOP, utiliser cityData dynamique

‚ñ° Nouveau fichier cr√©√© ?
  SI OUI ‚Üí V√©rifier emplacement correct (pas racine pollu√©e)
```

**Si 1+ probl√®me** ‚Üí STOP et demander avant de continuer

---

## üìÅ FICHIERS SYST√àME

### Documentation Strat√©gique (LECTURE OBLIGATOIRE)

- **Index** : `.cursor/INDEX-DOCUMENTATION.md` (point d'entr√©e)
- **Principes** : `.cursor/PRINCIPES-SACRES.md` ‚≠ê‚≠ê‚≠ê
- **Zones risque** : `.cursor/ZONES-DE-RISQUE.md` ‚≠ê‚≠ê‚≠ê
- **Checklist** : `.cursor/CHECKLIST-PRE-CODE.md` ‚≠ê‚≠ê‚≠ê
- **Architecture** : `.cursor/ARCHITECTURE-MULTISITES.md` ‚≠ê‚≠ê

### Gestion des T√¢ches

- **BACKLOG** : `.cursor/BACKLOG.md` (toutes les t√¢ches)
- **TODO Guillaume** : `.cursor/TODO-GUILLAUME.md`
- **TODO Lucie** : `.cursor/TODO-Lucie.md`
- **Archive** : `.cursor/DONE.md` (t√¢ches finalis√©es)
- **Doc t√¢ches** : `.cursor/tasks/[PX]-TASK-XXX-nom/` (1 t√¢che = 1 dossier)
- **Guide** : `.cursor/README.md` (syst√®me complet)

### Workflows & Commandes

- **Clean tasks** : `.cursor/WORKFLOW-CLEAN-TASKS.md` (fin journ√©e)
- **Commandes** : `.cursor/COMMANDES-RAPIDES.md` (r√©f√©rence)
- **Aide-m√©moire** : `.cursor/AIDE-MEMOIRE-CLEAN-TASKS.md`

### Archives

- **Projet 404** : `.cursor/archives/projet-404/` (docs globales 404)
- **Rapports** : `.cursor/archives/rapports/` (rapports dat√©s)
- **Analyses** : `.cursor/archives/analyses/` (analyses temporaires)

---

## üö´ INTERDICTIONS

1. ‚ùå Coder sans t√¢che document√©e
2. ‚ùå Marquer FINALIS√â sans les 3 crit√®res
3. ‚ùå Abandonner sans revert du code
4. ‚ùå D√©marrer du nouveau avec des INCOMPLET non justifi√©es
5. ‚ùå Documentation/contexte dans le code source

---

## ‚úÖ R√âSUM√â WORKFLOW

```
BACKLOG.md (√©valuation Cursor)
    ‚Üì
TODO-[PERSONNE].md
    ‚Üì
.cursor/tasks/TASK-XXX-nom/ (cr√©ation doc)
    ‚Üì
üîÑ En cours (code + log progress.md)
    ‚Üì
    ‚îú‚Üí ‚ö†Ô∏è INCOMPLET (pause avec contexte) ‚Üí reprendre en priorit√©
    ‚îú‚Üí ‚ùå ABANDONN√âE (revert code + raison)
    ‚îî‚Üí ‚úÖ FINALIS√â (3 crit√®res valid√©s) ‚Üí DONE.md
```

---

**Ces r√®gles sont OBLIGATOIRES pour Guillaume ET Associ√©e.**
**Cursor doit les appliquer syst√©matiquement et de fa√ßon bienveillante.**

---

## üöÄ D√âMARRAGE SESSION CURSOR (AUTOMATIQUE)

**√Ä CHAQUE nouveau chat, Cursor DOIT OBLIGATOIREMENT** :

### √âTAPE 1 : Lire Documentation Strat√©gique (CRITIQUE - 20 min)

**Ordre strict** :

```
1. Lire `.cursor/INDEX-DOCUMENTATION.md` (point d'entr√©e, 3 min)
2. Lire `.cursor/PRINCIPES-SACRES.md` (5 min) ‚≠ê‚≠ê‚≠ê
3. Lire `.cursor/ZONES-DE-RISQUE.md` (10 min) ‚≠ê‚≠ê‚≠ê
4. Lire `.cursor/CHECKLIST-PRE-CODE.md` (3 min) ‚≠ê‚≠ê‚≠ê
```

**‚ö†Ô∏è POURQUOI OBLIGATOIRE** :

Ces docs √©vitent 95% des bugs r√©currents :
- Villes hardcod√©es (40% des bugs)
- Sync multi-sites oubli√© (30% des bugs)
- SEO cass√© (20% des bugs)
- Fichiers mal rang√©s (10% des bugs)

**Investissement** : 20 min  
**ROI** : √âvite 2-3h corrections

---

### √âTAPE 2 : Lire √âtat Actuel

```
5. Lire `.cursor/TODO-GUILLAUME.md` OU `.cursor/TODO-Lucie.md` (selon user)
   ‚Üí V√©rifier section "‚ö†Ô∏è INCOMPLET" (prioritaires)
   ‚Üí V√©rifier t√¢ches [P0] critiques
   ‚Üí Noter t√¢ches EN COURS
```

---

### √âTAPE 3 : Afficher R√©sum√©

**Cursor affiche** :

```
üëã Salut [Guillaume/Lucie] !

üìö Documentation strat√©gique lue :
‚úÖ PRINCIPES-SACRES (SEO first, 11 villes, cityData dynamique)
‚úÖ ZONES-DE-RISQUE (8 zones m√©moris√©es, RED FLAGS activ√©s)
‚úÖ CHECKLIST-PRE-CODE (workflow pr√©-code int√©gr√©)
‚úÖ TODO-[Personne] (√©tat actuel)

üìä √âtat actuel :
- üîÑ EN COURS : X t√¢ches
- ‚ö†Ô∏è INCOMPLET : Y t√¢ches [SI > 0 : ‚Üí PRIORITAIRES !]
- üî¥ [P0] Critiques : Z t√¢ches
- üü† [P1] Importantes : W t√¢ches

üéØ Recommandation :
[T√¢che prioritaire sugg√©r√©e avec raison]

Sur quoi veux-tu travailler ? üöÄ
```

---

### √âTAPE 4 : Si T√¢ches INCOMPLET ‚Üí Rappel OBLIGATOIRE

**SI Y > 0 (t√¢ches INCOMPLET)** :

Cursor DOIT afficher AVANT toute autre action :

```
‚ö†Ô∏è T√ÇCHES INCOMPL√àTES D√âTECT√âES

Tu as Y t√¢ches en pause :
1. [PX]-TASK-XXX : [titre] (en pause depuis X jours)
2. [PX]-TASK-YYY : [titre] (en pause depuis Y jours)

‚ö†Ô∏è Les t√¢ches INCOMPLET sont TOUJOURS prioritaires.

Veux-tu :
A) Reprendre une t√¢che INCOMPLET
B) Abandonner une t√¢che (avec revert code + doc raison)  
C) Exceptionnellement d√©marrer du nouveau (justifie pourquoi)

Choix ? (A/B/C)
```

**Si user choisit C** ‚Üí Cursor demande justification

---

### √âTAPE 5 : Attendre Instructions

**Cursor attend** que user dise quoi faire.

**Si user demande de coder directement sans t√¢che** :
‚Üí Cursor refuse poliment (voir section 1 "AVANT TOUTE MODIFICATION DE CODE")

---

## üîß SCRIPTS DISPONIBLES

### Scripts Multi-Sites (CRITIQUES)

| Script | Usage | Quand |
|--------|-------|-------|
| `./scripts/sync/sync-components.sh` | Sync composants 11 villes | Apr√®s modif components/ |
| `./scripts/sync/sync-config-files.sh` | Sync configs 11 villes | Apr√®s modif Dockerfile/configs |

**‚ö†Ô∏è ESSENTIELS** : √âvitent d√©synchronisation entre sites

### Scripts Analyse

| Script | Usage |
|--------|-------|
| `./scripts/analysis/analyze-404.mjs` | Analyser 404s internes |
| `./scripts/seo/seo-head-qa.ts` | QA metadata SEO |

### Scripts D√©ploiement

| Script | Usage |
|--------|-------|
| `./scripts/deploy/push-all-sites-to-github.sh` | Push 11 sites |
| `./scripts/deploy/redeploy-all-sites.sh` | Red√©ployer tout |

---

## ‚ö†Ô∏è NOUVELLES COMMANDES CURSOR

### Commande Clean Tasks (Fin de Journ√©e)

```bash
"Cursor, clean tasks"                    ‚Üí Workflow complet (10 min)
"Cursor, clean tasks en mode rapide"    ‚Üí Version rapide (5 min)
"Cursor, clean TASK-XXX"                 ‚Üí 1 t√¢che (3 min)
```

**Cursor suit** : `.cursor/WORKFLOW-CLEAN-TASKS.md` (9 √©tapes guid√©es)

### Syst√®me de Priorit√©s

**Dossiers tasks/ avec pr√©fixes visuels** :

- `[P0]-TASK-XXX` = üî¥ Critique / Bloquant
- `[P1]-TASK-XXX` = üü† Important
- `[P2]-TASK-XXX` = üü° Normal

Voir : `.cursor/tasks/PRIORITES-VISUELLES.md`

---


