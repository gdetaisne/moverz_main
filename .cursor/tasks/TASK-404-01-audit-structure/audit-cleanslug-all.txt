=== marseille ===
function cleanSlug(originalSlug: string, category: string): string {
  // Retirer le préfixe de catégorie redondant
  let cleanSlug = originalSlug;
  
  // Patterns de nettoyage spécifiques (ordre important!)
    const cleanPatterns = [
    // D'abord, retirer les préfixes de catégorie complets
    { from: /^demenagement-etudiant-bordeaux-/, to: '' },
    { from: /^demenagement-entreprise-bordeaux-/, to: '' },
    { from: /^demenagement-piano-bordeaux-/, to: '' },
    { from: /^demenagement-international-bordeaux-/, to: '' },
    { from: /^demenagement-longue-distance-bordeaux-/, to: '' },
    { from: /^demenagement-pas-cher-bordeaux-/, to: '' },
    { from: /^demenagement-urgent-bordeaux-/, to: '' },
    { from: /^devis-demenagement-bordeaux-/, to: '' },
    { from: /^garde-meuble-bordeaux-/, to: '' },
    { from: /^prix-demenagement-bordeaux-/, to: '' },
    { from: /^prix-demenagement-piano-bordeaux-/, to: '' },
    { from: /^prix-garde-meuble-bordeaux-/, to: '' },
    // Ensuite, retirer les patterns partiels en début
    { from: /^stockage-etudiant-bordeaux/, to: 'stockage-etudiant' },
    { from: /^cartons-gratuits-bordeaux/, to: 'cartons-gratuits' },
    { from: /^camion-demenagement-etudiant-bordeaux/, to: 'camion-demenagement-etudiant' },
    { from: /^assurance-demenagement-international-bordeaux/, to: 'assurance-demenagement-international' },
    { from: /^prix-demenagement-international-bordeaux/, to: 'prix-demenagement-international' },
    { from: /^emballage-demenagement-international-bordeaux/, to: 'emballage-demenagement-international' },
    { from: /^formalites-douanieres-demenagement-international-bordeaux/, to: 'formalites-douanieres-demenagement-international' },
    // Retirer "-bordeaux" en milieu de slug
    { from: /-bordeaux-/, to: '-' },
    // Retirer "-bordeaux" en fin
    // { from: /-bordeaux$/, to: '' },  // ✅ Option B: Garder ville dans slug (SEO local)
=== toulouse ===
function cleanSlug(originalSlug: string, category: string): string {
  // Retirer le préfixe de catégorie redondant
  let cleanSlug = originalSlug;
  
  // Patterns de nettoyage spécifiques (ordre important!)
    const cleanPatterns = [
    // D'abord, retirer les préfixes de catégorie complets
    { from: /^demenagement-etudiant-toulouse-/, to: '' },
    { from: /^demenagement-entreprise-toulouse-/, to: '' },
    { from: /^demenagement-piano-toulouse-/, to: '' },
    { from: /^demenagement-international-toulouse-/, to: '' },
    { from: /^demenagement-longue-distance-toulouse-/, to: '' },
    { from: /^demenagement-pas-cher-toulouse-/, to: '' },
    { from: /^demenagement-urgent-toulouse-/, to: '' },
    { from: /^devis-demenagement-toulouse-/, to: '' },
    { from: /^garde-meuble-toulouse-/, to: '' },
    { from: /^prix-demenagement-toulouse-/, to: '' },
    { from: /^prix-demenagement-piano-toulouse-/, to: '' },
    { from: /^prix-garde-meuble-toulouse-/, to: '' },
    // Ensuite, retirer les patterns partiels en début
    { from: /^stockage-etudiant-toulouse/, to: 'stockage-etudiant' },
    { from: /^cartons-gratuits-toulouse/, to: 'cartons-gratuits' },
    { from: /^camion-demenagement-etudiant-toulouse/, to: 'camion-demenagement-etudiant' },
    { from: /^assurance-demenagement-international-toulouse/, to: 'assurance-demenagement-international' },
    { from: /^prix-demenagement-international-toulouse/, to: 'prix-demenagement-international' },
    { from: /^emballage-demenagement-international-toulouse/, to: 'emballage-demenagement-international' },
    { from: /^formalites-douanieres-demenagement-international-toulouse/, to: 'formalites-douanieres-demenagement-international' },
    // Retirer "-toulouse" en milieu de slug
    { from: /-toulouse-/, to: '-' },
    // Retirer "-toulouse" en fin
    // { from: /-toulouse$/, to: '' },  // ✅ Option B: Garder ville dans slug (SEO local)
=== lyon ===
function cleanSlug(originalSlug: string, category: string): string {
  // Retirer le préfixe de catégorie redondant
  let cleanSlug = originalSlug;
  
  // Patterns de nettoyage spécifiques (ordre important!)
    const cleanPatterns = [
    // D'abord, retirer les préfixes de catégorie complets
    { from: /^demenagement-etudiant-bordeaux-/, to: '' },
    { from: /^demenagement-entreprise-bordeaux-/, to: '' },
    { from: /^demenagement-piano-bordeaux-/, to: '' },
    { from: /^demenagement-international-bordeaux-/, to: '' },
    { from: /^demenagement-longue-distance-bordeaux-/, to: '' },
    { from: /^demenagement-pas-cher-bordeaux-/, to: '' },
    { from: /^demenagement-urgent-bordeaux-/, to: '' },
    { from: /^devis-demenagement-bordeaux-/, to: '' },
    { from: /^garde-meuble-bordeaux-/, to: '' },
    { from: /^prix-demenagement-bordeaux-/, to: '' },
    { from: /^prix-demenagement-piano-bordeaux-/, to: '' },
    { from: /^prix-garde-meuble-bordeaux-/, to: '' },
    // Ensuite, retirer les patterns partiels en début
    { from: /^stockage-etudiant-bordeaux/, to: 'stockage-etudiant' },
    { from: /^cartons-gratuits-bordeaux/, to: 'cartons-gratuits' },
    { from: /^camion-demenagement-etudiant-bordeaux/, to: 'camion-demenagement-etudiant' },
    { from: /^assurance-demenagement-international-bordeaux/, to: 'assurance-demenagement-international' },
    { from: /^prix-demenagement-international-bordeaux/, to: 'prix-demenagement-international' },
    { from: /^emballage-demenagement-international-bordeaux/, to: 'emballage-demenagement-international' },
    { from: /^formalites-douanieres-demenagement-international-bordeaux/, to: 'formalites-douanieres-demenagement-international' },
    // Retirer "-bordeaux" en milieu de slug
    { from: /-bordeaux-/, to: '-' },
    // Retirer "-bordeaux" en fin
    // { from: /-bordeaux$/, to: '' },  // ✅ Option B: Garder ville dans slug (SEO local)
=== bordeaux ===
function cleanSlug(originalSlug: string, category: string): string {
  // Retirer le préfixe de catégorie redondant
  let cleanSlug = originalSlug;
  
  // Patterns de nettoyage spécifiques (ordre important!)
    const cleanPatterns = [
    // D'abord, retirer les préfixes de catégorie complets
    { from: /^demenagement-etudiant-bordeaux-/, to: '' },
    { from: /^demenagement-entreprise-bordeaux-/, to: '' },
    { from: /^demenagement-piano-bordeaux-/, to: '' },
    { from: /^demenagement-international-bordeaux-/, to: '' },
    { from: /^demenagement-longue-distance-bordeaux-/, to: '' },
    { from: /^demenagement-pas-cher-bordeaux-/, to: '' },
    { from: /^demenagement-urgent-bordeaux-/, to: '' },
    { from: /^devis-demenagement-bordeaux-/, to: '' },
    { from: /^garde-meuble-bordeaux-/, to: '' },
    { from: /^prix-demenagement-bordeaux-/, to: '' },
    { from: /^prix-demenagement-piano-bordeaux-/, to: '' },
    { from: /^prix-garde-meuble-bordeaux-/, to: '' },
    // Ensuite, retirer les patterns partiels en début
    { from: /^stockage-etudiant-bordeaux/, to: 'stockage-etudiant' },
    { from: /^cartons-gratuits-bordeaux/, to: 'cartons-gratuits' },
    { from: /^camion-demenagement-etudiant-bordeaux/, to: 'camion-demenagement-etudiant' },
    { from: /^assurance-demenagement-international-bordeaux/, to: 'assurance-demenagement-international' },
    { from: /^prix-demenagement-international-bordeaux/, to: 'prix-demenagement-international' },
    { from: /^emballage-demenagement-international-bordeaux/, to: 'emballage-demenagement-international' },
    { from: /^formalites-douanieres-demenagement-international-bordeaux/, to: 'formalites-douanieres-demenagement-international' },
    // Retirer "-bordeaux" en milieu de slug
    { from: /-bordeaux-/, to: '-' },
    // Retirer "-bordeaux" en fin
    // { from: /-bordeaux$/, to: '' },  // ✅ Option B: Garder ville dans slug (SEO local)
=== nantes ===
function cleanSlug(originalSlug: string, category: string): string {
  // Retirer le préfixe de catégorie redondant
  let cleanSlug = originalSlug;
  
  // Patterns de nettoyage spécifiques (ordre important!)
    const cleanPatterns = [
    // D'abord, retirer les préfixes de catégorie complets
    { from: /^demenagement-etudiant-bordeaux-/, to: '' },
    { from: /^demenagement-entreprise-bordeaux-/, to: '' },
    { from: /^demenagement-piano-bordeaux-/, to: '' },
    { from: /^demenagement-international-bordeaux-/, to: '' },
    { from: /^demenagement-longue-distance-bordeaux-/, to: '' },
    { from: /^demenagement-pas-cher-bordeaux-/, to: '' },
    { from: /^demenagement-urgent-bordeaux-/, to: '' },
    { from: /^devis-demenagement-bordeaux-/, to: '' },
    { from: /^garde-meuble-bordeaux-/, to: '' },
    { from: /^prix-demenagement-bordeaux-/, to: '' },
    { from: /^prix-demenagement-piano-bordeaux-/, to: '' },
    { from: /^prix-garde-meuble-bordeaux-/, to: '' },
    // Ensuite, retirer les patterns partiels en début
    { from: /^stockage-etudiant-bordeaux/, to: 'stockage-etudiant' },
    { from: /^cartons-gratuits-bordeaux/, to: 'cartons-gratuits' },
    { from: /^camion-demenagement-etudiant-bordeaux/, to: 'camion-demenagement-etudiant' },
    { from: /^assurance-demenagement-international-bordeaux/, to: 'assurance-demenagement-international' },
    { from: /^prix-demenagement-international-bordeaux/, to: 'prix-demenagement-international' },
    { from: /^emballage-demenagement-international-bordeaux/, to: 'emballage-demenagement-international' },
    { from: /^formalites-douanieres-demenagement-international-bordeaux/, to: 'formalites-douanieres-demenagement-international' },
    // Retirer "-bordeaux" en milieu de slug
    { from: /-bordeaux-/, to: '-' },
    // Retirer "-bordeaux" en fin
    // { from: /-bordeaux$/, to: '' },  // ✅ Option B: Garder ville dans slug (SEO local)
=== lille ===
function cleanSlug(originalSlug: string, category: string): string {
  // Retirer le préfixe de catégorie redondant
  let cleanSlug = originalSlug;
  
  // Patterns de nettoyage spécifiques (ordre important!)
    const cleanPatterns = [
    // D'abord, retirer les préfixes de catégorie complets
    { from: /^demenagement-etudiant-bordeaux-/, to: '' },
    { from: /^demenagement-entreprise-bordeaux-/, to: '' },
    { from: /^demenagement-piano-bordeaux-/, to: '' },
    { from: /^demenagement-international-bordeaux-/, to: '' },
    { from: /^demenagement-longue-distance-bordeaux-/, to: '' },
    { from: /^demenagement-pas-cher-bordeaux-/, to: '' },
    { from: /^demenagement-urgent-bordeaux-/, to: '' },
    { from: /^devis-demenagement-bordeaux-/, to: '' },
    { from: /^garde-meuble-bordeaux-/, to: '' },
    { from: /^prix-demenagement-bordeaux-/, to: '' },
    { from: /^prix-demenagement-piano-bordeaux-/, to: '' },
    { from: /^prix-garde-meuble-bordeaux-/, to: '' },
    // Ensuite, retirer les patterns partiels en début
    { from: /^stockage-etudiant-bordeaux/, to: 'stockage-etudiant' },
    { from: /^cartons-gratuits-bordeaux/, to: 'cartons-gratuits' },
    { from: /^camion-demenagement-etudiant-bordeaux/, to: 'camion-demenagement-etudiant' },
    { from: /^assurance-demenagement-international-bordeaux/, to: 'assurance-demenagement-international' },
    { from: /^prix-demenagement-international-bordeaux/, to: 'prix-demenagement-international' },
    { from: /^emballage-demenagement-international-bordeaux/, to: 'emballage-demenagement-international' },
    { from: /^formalites-douanieres-demenagement-international-bordeaux/, to: 'formalites-douanieres-demenagement-international' },
    // Retirer "-bordeaux" en milieu de slug
    { from: /-bordeaux-/, to: '-' },
    // Retirer "-bordeaux" en fin
    // { from: /-bordeaux$/, to: '' },  // ✅ Option B: Garder ville dans slug (SEO local)
=== nice ===
function cleanSlug(originalSlug: string, category: string): string {
  // Ne PAS retirer les préfixes - garder les slugs complets pour éviter les collisions
  // Seulement simplifier "-guide-complet" → "-guide"
  let cleanSlug = originalSlug;
  
  cleanSlug = cleanSlug.replace(/-guide-complet$/, '-guide');
  
  return cleanSlug;
}

export function getAllBlogPosts(): BlogPost[] {
  const monorepoDir = path.join(process.cwd(), 'sites/nice/content/blog');
  const standaloneDir = path.join(process.cwd(), 'content/blog');
  const blogDirectory = fs.existsSync(monorepoDir)
    ? monorepoDir
    : (fs.existsSync(standaloneDir) ? standaloneDir : null);

  if (!blogDirectory) {
    return [];
  }
  const categories = fs.readdirSync(blogDirectory, { withFileTypes: true })
    .filter(dirent => dirent.isDirectory())
    .map(dirent => dirent.name);

  const allPosts: BlogPost[] = [];

  categories.forEach(category => {
    const categoryPath = path.join(blogDirectory, category);
    const files = fs.readdirSync(categoryPath)
      .filter(file => file.endsWith('.md') && file !== 'README.md');

=== strasbourg ===
function cleanSlug(originalSlug: string, category: string): string {
  // Retirer le préfixe de catégorie redondant
  let cleanSlug = originalSlug;
  
  // Patterns de nettoyage spécifiques (ordre important!)
    const cleanPatterns = [
    // D'abord, retirer les préfixes de catégorie complets
    { from: /^demenagement-etudiant-bordeaux-/, to: '' },
    { from: /^demenagement-entreprise-bordeaux-/, to: '' },
    { from: /^demenagement-piano-bordeaux-/, to: '' },
    { from: /^demenagement-international-bordeaux-/, to: '' },
    { from: /^demenagement-longue-distance-bordeaux-/, to: '' },
    { from: /^demenagement-pas-cher-bordeaux-/, to: '' },
    { from: /^demenagement-urgent-bordeaux-/, to: '' },
    { from: /^devis-demenagement-bordeaux-/, to: '' },
    { from: /^garde-meuble-bordeaux-/, to: '' },
    { from: /^prix-demenagement-bordeaux-/, to: '' },
    { from: /^prix-demenagement-piano-bordeaux-/, to: '' },
    { from: /^prix-garde-meuble-bordeaux-/, to: '' },
    // Ensuite, retirer les patterns partiels en début
    { from: /^stockage-etudiant-bordeaux/, to: 'stockage-etudiant' },
    { from: /^cartons-gratuits-bordeaux/, to: 'cartons-gratuits' },
    { from: /^camion-demenagement-etudiant-bordeaux/, to: 'camion-demenagement-etudiant' },
    { from: /^assurance-demenagement-international-bordeaux/, to: 'assurance-demenagement-international' },
    { from: /^prix-demenagement-international-bordeaux/, to: 'prix-demenagement-international' },
    { from: /^emballage-demenagement-international-bordeaux/, to: 'emballage-demenagement-international' },
    { from: /^formalites-douanieres-demenagement-international-bordeaux/, to: 'formalites-douanieres-demenagement-international' },
    // Retirer "-bordeaux" en milieu de slug
    { from: /-bordeaux-/, to: '-' },
    // Retirer "-bordeaux" en fin
    // { from: /-bordeaux$/, to: '' },  // ✅ Option B: Garder ville dans slug (SEO local)
=== rouen ===
function cleanSlug(originalSlug: string, category: string): string {
  // Retirer le préfixe de catégorie redondant
  let cleanSlug = originalSlug;
  
  // Patterns de nettoyage spécifiques (ordre important!)
    const cleanPatterns = [
    // D'abord, retirer les préfixes de catégorie complets
    { from: /^demenagement-etudiant-bordeaux-/, to: '' },
    { from: /^demenagement-entreprise-bordeaux-/, to: '' },
    { from: /^demenagement-piano-bordeaux-/, to: '' },
    { from: /^demenagement-international-bordeaux-/, to: '' },
    { from: /^demenagement-longue-distance-bordeaux-/, to: '' },
    { from: /^demenagement-pas-cher-bordeaux-/, to: '' },
    { from: /^demenagement-urgent-bordeaux-/, to: '' },
    { from: /^devis-demenagement-bordeaux-/, to: '' },
    { from: /^garde-meuble-bordeaux-/, to: '' },
    { from: /^prix-demenagement-bordeaux-/, to: '' },
    { from: /^prix-demenagement-piano-bordeaux-/, to: '' },
    { from: /^prix-garde-meuble-bordeaux-/, to: '' },
    // Ensuite, retirer les patterns partiels en début
    { from: /^stockage-etudiant-bordeaux/, to: 'stockage-etudiant' },
    { from: /^cartons-gratuits-bordeaux/, to: 'cartons-gratuits' },
    { from: /^camion-demenagement-etudiant-bordeaux/, to: 'camion-demenagement-etudiant' },
    { from: /^assurance-demenagement-international-bordeaux/, to: 'assurance-demenagement-international' },
    { from: /^prix-demenagement-international-bordeaux/, to: 'prix-demenagement-international' },
    { from: /^emballage-demenagement-international-bordeaux/, to: 'emballage-demenagement-international' },
    { from: /^formalites-douanieres-demenagement-international-bordeaux/, to: 'formalites-douanieres-demenagement-international' },
    // Retirer "-bordeaux" en milieu de slug
    { from: /-bordeaux-/, to: '-' },
    // Retirer "-bordeaux" en fin
    // { from: /-bordeaux$/, to: '' },  // ✅ Option B: Garder ville dans slug (SEO local)
=== rennes ===
function cleanSlug(originalSlug: string, category: string): string {
  // Retirer le préfixe de catégorie redondant
  let cleanSlug = originalSlug;
  
  // Patterns de nettoyage spécifiques (ordre important!)
    const cleanPatterns = [
    // D'abord, retirer les préfixes de catégorie complets
    { from: /^demenagement-etudiant-bordeaux-/, to: '' },
    { from: /^demenagement-entreprise-bordeaux-/, to: '' },
    { from: /^demenagement-piano-bordeaux-/, to: '' },
    { from: /^demenagement-international-bordeaux-/, to: '' },
    { from: /^demenagement-longue-distance-bordeaux-/, to: '' },
    { from: /^demenagement-pas-cher-bordeaux-/, to: '' },
    { from: /^demenagement-urgent-bordeaux-/, to: '' },
    { from: /^devis-demenagement-bordeaux-/, to: '' },
    { from: /^garde-meuble-bordeaux-/, to: '' },
    { from: /^prix-demenagement-bordeaux-/, to: '' },
    { from: /^prix-demenagement-piano-bordeaux-/, to: '' },
    { from: /^prix-garde-meuble-bordeaux-/, to: '' },
    // Ensuite, retirer les patterns partiels en début
    { from: /^stockage-etudiant-bordeaux/, to: 'stockage-etudiant' },
    { from: /^cartons-gratuits-bordeaux/, to: 'cartons-gratuits' },
    { from: /^camion-demenagement-etudiant-bordeaux/, to: 'camion-demenagement-etudiant' },
    { from: /^assurance-demenagement-international-bordeaux/, to: 'assurance-demenagement-international' },
    { from: /^prix-demenagement-international-bordeaux/, to: 'prix-demenagement-international' },
    { from: /^emballage-demenagement-international-bordeaux/, to: 'emballage-demenagement-international' },
    { from: /^formalites-douanieres-demenagement-international-bordeaux/, to: 'formalites-douanieres-demenagement-international' },
    // Retirer "-bordeaux" en milieu de slug
    { from: /-bordeaux-/, to: '-' },
    // Retirer "-bordeaux" en fin
    // { from: /-bordeaux$/, to: '' },  // ✅ Option B: Garder ville dans slug (SEO local)
=== montpellier ===
function cleanSlug(originalSlug: string, category: string): string {
  // Retirer le préfixe de catégorie redondant
  let cleanSlug = originalSlug;
  
  // Patterns de nettoyage spécifiques (ordre important!)
    const cleanPatterns = [
    // D'abord, retirer les préfixes de catégorie complets
    { from: /^demenagement-etudiant-bordeaux-/, to: '' },
    { from: /^demenagement-entreprise-bordeaux-/, to: '' },
    { from: /^demenagement-piano-bordeaux-/, to: '' },
    { from: /^demenagement-international-bordeaux-/, to: '' },
    { from: /^demenagement-longue-distance-bordeaux-/, to: '' },
    { from: /^demenagement-pas-cher-bordeaux-/, to: '' },
    { from: /^demenagement-urgent-bordeaux-/, to: '' },
    { from: /^devis-demenagement-bordeaux-/, to: '' },
    { from: /^garde-meuble-bordeaux-/, to: '' },
    { from: /^prix-demenagement-bordeaux-/, to: '' },
    { from: /^prix-demenagement-piano-bordeaux-/, to: '' },
    { from: /^prix-garde-meuble-bordeaux-/, to: '' },
    // Ensuite, retirer les patterns partiels en début
    { from: /^stockage-etudiant-bordeaux/, to: 'stockage-etudiant' },
    { from: /^cartons-gratuits-bordeaux/, to: 'cartons-gratuits' },
    { from: /^camion-demenagement-etudiant-bordeaux/, to: 'camion-demenagement-etudiant' },
    { from: /^assurance-demenagement-international-bordeaux/, to: 'assurance-demenagement-international' },
    { from: /^prix-demenagement-international-bordeaux/, to: 'prix-demenagement-international' },
    { from: /^emballage-demenagement-international-bordeaux/, to: 'emballage-demenagement-international' },
    { from: /^formalites-douanieres-demenagement-international-bordeaux/, to: 'formalites-douanieres-demenagement-international' },
    // Retirer "-bordeaux" en milieu de slug
    { from: /-bordeaux-/, to: '-' },
    // Retirer "-bordeaux" en fin
    // { from: /-bordeaux$/, to: '' },  // ✅ Option B: Garder ville dans slug (SEO local)
