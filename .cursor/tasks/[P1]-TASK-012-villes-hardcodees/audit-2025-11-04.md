# Audit hardcodes villes — 04/11/2025

## Objectif
Identifier de façon exhaustive les occurrences à risque de villes hardcodées (UX/SEO) dans le code (hors contenu blog), prioriser par impact.

## Méthodologie (grep)
- Scope: `sites/**/{app,components,lib}/**/*.{tsx,ts,mdx,md}` (exclu: `content/blog/`)
- Patterns principaux:
  - `à {Ville}` (expressions textuelles)
  - `quartiers-{ville}` (liens/canonicals quartiers)
  - Gardes-fous: `const ville = "Ville"`, `if (city === 'slug')`
  - Noms de quartiers sentinelles: `Chartrons|Vieux-Port|Capitole`

## Résultats clés

### 1) Hardcode critique détecté (global)
- 12 occurrences de `quartiers-lille` dans `components/NeighborhoodsTeaser.tsx` copiés sur TOUTES les villes.
- Fichiers concernés:
  - `sites/nice/components/NeighborhoodsTeaser.tsx`
  - `sites/lyon/components/NeighborhoodsTeaser.tsx`
  - `sites/marseille/components/NeighborhoodsTeaser.tsx`
  - `sites/nantes/components/NeighborhoodsTeaser.tsx`
  - `sites/rennes/components/NeighborhoodsTeaser.tsx`
  - `sites/strasbourg/components/NeighborhoodsTeaser.tsx`
  - `sites/rouen/components/NeighborhoodsTeaser.tsx`
  - `sites/toulouse/components/NeighborhoodsTeaser.tsx`
  - `sites/montpellier/components/NeighborhoodsTeaser.tsx`
  - `sites/bordeaux/components/NeighborhoodsTeaser.tsx`
  - `sites/lille/components/NeighborhoodsTeaser.tsx` (OK pour Lille)
  - `sites/nantes/components/NeighborhoodsTeaser.tsx` (doublon confirmé)

Impact: Très élevé (risque de mauvais canonical/maillage interne quartiers vers Lille depuis d’autres villes).

### 2) Garde-fous code
- Aucune occurrence trouvée pour:
  - `const ville = "{Ville}"`
  - `if (city === '{slug}')`

=> Bon signal: pas de logique conditionnelle hardcodée détectée.

### 3) Liens inter-villes absolus
- Aucune occurrence de `href="/(nice|lille|...)"` détectée dans `sites/**` (app/components).

### 4) Noms de quartiers
- Occurrences nombreuses (533) mais majoritairement dans contenu/blog et datas par ville (attendu). Pas d’anomalie évidente en code transverse.

## Priorisation (risque)
- P0: `NeighborhoodsTeaser.tsx` (11 villes impactées, SEO/UX critique)
- P2: Vérification opportuniste des pages quartiers spécifiques (OK sur Lille uniquement observé)
- P3: Ajout d’un garde-fou CI (grep) pour empêcher régression (`quartiers-(nice|...)` dans components)

## Conclusion
Le point bloquant principal est unique et clair: un hardcode `quartiers-lille` recopié dans le composant `NeighborhoodsTeaser.tsx` sur toutes les villes. Corriger la source et synchroniser les 11 sites suffit à résorber >90% du risque lié aux villes hardcodées sur cette zone.
